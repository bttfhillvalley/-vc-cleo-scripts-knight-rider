{$CLEO .cs}
{$INCLUDE Common/CleoConstants.txt}
0000:
thread 'WEATHER'
int weather
int year
int month
int day
int curr_time
int hour
int minute
int set_time_var
00BF: hour = current_time_hours, minute = current_time_minutes

while true
    wait 0
    // Get Date
    0AB4: day = var CDATE
    year = day
    year /= 10000
    year *= 10000
    day -= year
    year /= 10000

    month = day
    month /= 100
    month *= 100
    day -= month
    month /= 100

    // Real Time control
    0AB4: set_time_var = var SET_TIME
    if
        set_time_var == 1
    then
        timera = 0
        00BF: hour = current_time_hours, minute = current_time_minutes
    end

    if
        timera >= 60000
    then
        timera = 0
        minute += 1
        if
            minute >= 60
        then
            minute = 0
            hour += 1
        end
        if
            hour >= 24
        then
            hour = 0
        end
    end
    00C0: set_current_time hour minute
    if
        month == 1
    then
        weather = 1 // Overcast
    else
    if or
        month == 2
        month == 12
    then
        weather = 3 // Fog
    else if
        month == 3
    then
        weather = 9 // Grey sky
    else if
        month == 4
    then
        weather = 5 // Hurricane
    else if
        month == 5
    then
        weather = 7 // Light sky
    else if or
        month == 6
        month == 9
    then
        weather = 0 // Mostly clear
    else if
        month == 7
    then
        weather = 4 // Clear
    else if or
        month == 8
        month == 10
        month == 11
    then
        weather = 7 // Mostly clear
        if and
            month == 11
            day == 12
            year == 1955
        then
            if and
                curr_time >= 2000
                curr_time < 2150
            then
                weather = 8 // Overcast
            else if and
                curr_time >= 2150
                curr_time < 2204
            then
                weather = 2 // Rain/Lightning
            else if and
                curr_time >= 2204
                curr_time < 2206
            then
                weather = 1 // Overcast
            else if
                curr_time >= 2210
            then
                weather = 5 // Hurricane
            end
            end
            end
            end
        else if and
            month == 10
            day == 21
            year == 2015
            curr_time < 1634
        then
            weather = 5 // Hurricane
        else if and
            // 1985 A preview
            month == 10
            day > 27
            year == 1985
        then
            weather = 6 // Dark sky
        end
        end
        end
    else
        weather = 10 // Paradox
    end
    end
    end
    end
    end
    end
    end
    end
    set_weather weather
end
