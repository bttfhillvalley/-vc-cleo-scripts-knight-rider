{$CLEO .s}
{$INCLUDE Variables.txt}
{$INCLUDE ../Common/CleoConstants.txt}
0000:
int oxygen
int sethealth

0000:
while true 
    wait 10
    if
        not Player.Defined($PLAYER_CHAR)
    then
        continue
    end

    if
        80DD:   not actor $player_actor driving_vehicle_type 239
    then
        continue
    end
    03C1: vehicle = player $PLAYER_CHAR car 
    gosub @CheckKey
    gosub @setthehealth
3F02: Engine_IO = car vehicle engine_status 
sethealth = Actor.Health($PLAYER_ACTOR)

end

:CheckKey
if and
Engine_IO == 1
not sethealth == 100
    is_key_pressed KEY_OXYGEN
    timera > 500
then
    timera = 0
    // Toggle oxygen
    if
        oxygen == 0
    then
        oxygen = 1
        gosub @oxygen_Up
    end
end
return

:oxygen_Down 
3F18: set_car vehicle component "oxygenled" glow 0
wait 400 
for x = 30.0 downto 0.0 step 1.0
3F16: rotate_car_part "oxygen" angle x 0.0 0.0 car vehicle
3F16: rotate_car_part "oxygenled" angle x 0.0 0.0 car vehicle
wait 0
end 
oxygen = 0 
    wait 0  
return


:oxygen_Up
3F18: set_car vehicle component "oxygenled" glow 0
for x = 0.0 to 30.0 step 1.0
3F16: rotate_car_part "oxygen" angle x 0.0 0.0 car vehicle
3F16: rotate_car_part "oxygenled" angle x 0.0 0.0 car vehicle
wait 0
end
wait 400
3F18: set_car vehicle component "oxygenled" glow 1 
wait 0
return  


:setthehealth
wait 0
if and
oxygen == 1
not sethealth == 100
then
sethealth += 1 // $ += int 
Actor.Health($PLAYER_ACTOR) = sethealth
wait 0
if and
oxygen == 1
sethealth == 100
then
gosub @oxygen_Down
end
end
return

