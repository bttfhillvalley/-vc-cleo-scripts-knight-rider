{$INCLUDE ../../Common/CleoConstants.txt}
{$INCLUDE Variables.txt}

:ExplosionSound
0AB4: var1 = var MODE
if or
    80DC:   not player $PLAYER_CHAR driving vehicle
    var1 == 0 // Cutscene Camera
then
    if or
        Car.Model(vehicle) == #BUS
        Car.Model(vehicle) == #MAVERICK
    then
        // Train
        3F95: var2 = play_sound "train_timetravel.wav" pos x y z loop 0 min 30.0
    else
        0AB4: var2 = var WIRE
        if
            var2 == 0 // Did not hit the clocktower wire?
        then
            // Delorean
            3F95: var2 = play_sound "delorean_timetravel.wav" pos x y z loop 0 min 30.0
        else
            // Clocktower
            3F95: var2 = play_sound "clocktower_timetravel.wav" pos x y z loop 0 min 30.0
        end
    end
else
    // Instant
    3F95: var2 = play_sound "instant_timetravel.wav" pos x y z loop 0 min 30.0                                                                                      
end
return

:ResetSounds
0B10: var1 = vehicle_flags AND TC_FRIED_BIT
0B10: var2 = vehicle_flags AND TC_BIT
if or
    vehicle_speed < 44.0
    not var1 == 0 // Time Circuits are fried
    var2 == 0 // Time Circuits are Off
then
    if
        3F92: is_sound_playing "sparks.wav" index vehicle
    then
        3F91: stop_sound "sparks.wav" index vehicle
    end
    if
        3F92: is_sound_playing "sparks_bttf3.wav" index vehicle
    then
        3F91: stop_sound "sparks_bttf3.wav" index vehicle
    end
end
return